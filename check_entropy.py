import pefile
import math

#pe = pefile.PE('/media/sandeep/DATA/raw_final_dataset/RAW_final_dataset/Benign/SpotifySetup.exe')
pe = pefile.PE('/media/sandeep/DATA/raw_final_dataset/RAW_final_dataset/Virus_samples/VirusShare_4a6b41c239dd943b77b74737c670e610')


def check_entropy(pe):
    entropies = []
    for section in pe.sections:
        sectionname = ''.join(filter(lambda c: c != '\0', str(section.Name.decode('utf-8'))))
        entropies.append(sectionname)
        entropy = section.get_entropy()
        if entropy < 1.0:
             a = "Entropy < 1.0"
        elif entropy > 7.0:
             a = "Entropy > 7.0"
        else:  # 7.0 .. 8.0
             a = "1.0 < Entropy < 7.0"
        entropies.append(a)
    print(entropies)


check_entropy(pe)
