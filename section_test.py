import pefile

# pe = pefile.PE(
#     '/media/sandeep/DATA/raw_final_dataset/RAW_final_dataset/Virus_samples/VirusShare_4a6b41c239dd943b77b74737c670e610')

pe = pefile.PE('/media/sandeep/DATA/raw_final_dataset/RAW_final_dataset/Adware_samples/VirusShare_4b9b61fefc3d8732974429fff2ac1920')

# for section in pe.sections:
#     print(section.Name)

dSections = {
    # List of section names
    '.data': 'Data Section',
    '.reloc': 'Relocations Section',
    '.rsrc': 'Resource section',
    '.rdata': 'Read-only initialized Data Section  (MS and Borland)',
}

for section in pe.sections:
    sectionname = ''.join(filter(lambda c: c != '\0', str(section.Name.decode('utf-8'))))

    if sectionname in dSections:
        print(sectionname)
    else: print("0")
