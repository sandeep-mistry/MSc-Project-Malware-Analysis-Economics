import pefile

pe = pefile.PE('/media/sandeep/DATA/raw_final_dataset/RAW_final_dataset/Benign/SpotifySetup.exe')
# pe = pefile.PE('/media/sandeep/DATA/raw_final_dataset/RAW_final_dataset/Virus_samples/VirusShare_4a6b41c239dd943b77b74737c670e610')


def virtual_size_raw_size_ratio(pe):
    verdicts = []
    for section in pe.sections:
        sectionname = ''.join(filter(lambda c: c != '\0', str(section.Name.decode('utf-8'))))
        verdicts.append(sectionname)
        raw_size = section.SizeOfRawData
        virtual_size = section.Misc_VirtualSize
        if 0.5 * virtual_size > raw_size:
            verdict = "Malicious section"
        else:
            verdict = "Benign section"
        verdicts.append(verdict)
    print(verdicts)


virtual_size_raw_size_ratio(pe)