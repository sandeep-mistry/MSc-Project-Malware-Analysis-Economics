import pefile

pe = pefile.PE('/media/sandeep/DATA/raw_final_dataset/Benign/SpotifySetup.exe')
# pe = pefile.PE('/media/sandeep/DATA/raw_final_dataset/Samples/Virus_samples/VirusShare_4a6b41c239dd943b77b74737c670e610')
SECTION_ENTROPIES_HEADER = ['.idata', '.rdata', '.data', '.rsrc', '.reloc']


def check_entropy(pe):
    entropies = {}
    present_entropies = []
    for section in pe.sections:
        sectionname = ''.join(filter(lambda c: c != '\0', str(section.Name.decode('utf-8'))))
        get_entropy = section.get_entropy()
        entropies.update({sectionname: get_entropy})

    for item in SECTION_ENTROPIES_HEADER:
        for key, value in entropies.items():
            if key == item:
                present_entropies.append(value)
        if item not in entropies:
            present_entropies.append(" ")
        else:
            continue


check_entropy(pe)
