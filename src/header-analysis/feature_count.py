import numpy as np
import scipy.sparse
import matplotlib.pyplot as plt

# one_gram_matrix = "/home/sandeep/outputs/model/byte1g_matrix.npy"
# two_gram_matrix = "/home/sandeep/outputs/model/byte2g_matrix.npz"
# three_gram_matrix = "/home/sandeep/outputs/model/byte3g_matrix.npz"
#
# byte1g_matrix = np.load(one_gram_matrix)
# byte2g_matrix = scipy.sparse.load_npz(two_gram_matrix)
# byte3g_matrix = scipy.sparse.load_npz(three_gram_matrix)
#
# print("1 gram:", np.shape(byte1g_matrix))
# print("2 gram:", np.shape(byte2g_matrix))
# print("3 gram:", np.shape(byte3g_matrix))

header = 115
one_gram = 257
two_gram = 65536
three_gram = 546307

feature_counts = [115, 257, 65536, 546307]
n_grams = ["Header features", "1-gram", "2-gram", "3-gram"]

for (a, b) in zip(n_grams, feature_counts):
    plt.bar(a, b, color='tab:blue')
plt.yscale('log')
plt.xlabel('Feature extraction method')
plt.ylabel('Raw feature count')
plt.show()
