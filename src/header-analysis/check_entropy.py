import pefile

desired_sections_entropy_virtual_size = ['.idata', '.rdata', '.data', '.rsrc', '.reloc']


def check_entropy(pe):
    entropies = {}
    PRESENT_ENTROPIES_data = []
    for section in pe.sections:
        sectionname = ''.join(filter(lambda c: c != '\0', str(section.Name.decode('utf-8'))))
        get_entropy = section.get_entropy()
        entropies.update({sectionname: get_entropy})

    for item in desired_sections_entropy_virtual_size :
        for key, value in entropies.items():
            if key == item:
                PRESENT_ENTROPIES_data.append(value)
        if item not in entropies:
            PRESENT_ENTROPIES_data.append(None)
        else:
            continue
    return PRESENT_ENTROPIES_data
