import pefile

path = "/media/sandeep/DATA/raw_final_dataset/Benign/SpotifySetup.exe"
pe = pefile.PE(path)

IMPORTED_API_COUNT = ["KERNEL", "USER", "ADVAPI", "SHELL", "COMCTL", "CRYPT", "MSVCR", "GDI", "SHLWAPI", "WS", "WININET", "WINHTTP"]
desired_directory_entry_imports = [b"KERNEL", b"USER", b"ADVAPI", b"SHELL", b"COMCTL", b"CRYPT", b"MSVCR", b"GDI", b"SHLWAPI", b"WS", b"WININET", b"WINHTTP"]


def get_imported_api_counts(pe):
    IMPORTED_API_COUNT_data = []

    for item in desired_directory_entry_imports:
        item_count = 0
        for entry in pe.DIRECTORY_ENTRY_IMPORT:
            entry_dll = entry.dll
            if entry_dll.startswith(item):
                item_count += len(entry.imports)
            else:
                continue
        IMPORTED_API_COUNT_data.append(item_count)
    return IMPORTED_API_COUNT_data


def get_imported_libraries_count(pe):
    count = 0
    for entry in pe.DIRECTORY_ENTRY_IMPORT:
        while True:
            count += 1
            break
    return count



